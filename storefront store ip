<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">

  <title>The Mandela Effect</title>
  <meta name="DCSP Project">
  <meta name="Brady Kruse & Others">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="storefront.js"></script>

</head>

<body>

<a href='cart.php'>Click here to view cart</a>
<a href='account.php'>Click here to view account</a>

</body>

<?php
session_start();
require_once('login.php');
$conn = new mysqli($hn, $un, $pw, $db);

if($_SESSION['type']=='guest'){
  $_SESSION['username'] = $_SERVER['REMOTE_ADDR']; #On account log-in / log-out, need to compensate for guests. #Also, on account creation, if a table already exists for the IP, copy over their cart. Also need to make sure to create cart for all new users.
  $_SESSION['type'] = 'guest';
  $query = "INSERT INTO users (username, type) VALUES('" . $_SESSION['username'] . "', 'guest')";
  $result = $conn->query($query);
  $query = "CREATE TABLE '" . $_SESSION['username'] . "'(
    itemID     INTEGER,
    image_link    VARCHAR(1028),
    item_name   VARCHAR(256),
    quantity    INTEGER,
    PRIMARY KEY (itemID)
  )";
  $hash_password = hash('192.168.0.9', "$salt1$password$salt2");
  echo "$hash_password";
  $result = $conn->query($query);

  echo "<h1>Welcome Guest </h1>";
}
else{
echo "<h1>Welcome " . $_SESSION['username'] . " </h1>";
}

echo "<p>We currently have the following items</p>";

$query = "SELECT * FROM items";
$result = $conn->query($query);

while($row = $result->fetch_array()){
 echo
 "<img id=" . $row['itemID'] . " src=" . $row['image_link'] . " alt=" . $row['item_name'] . " width=128 height=128 " . $row['itemID'] . ")></img>"; #STYLING!! #Need buttons for remove from cart / add to cart
 echo
 "<button onclick='AddToCart(" . $row['itemID'] . ")'> Add to cart </button>";
 echo
 "<button onclick='RemoveFromCart(" . $row['itemID'] . ")'> Remove from cart </button>";
}

?>

</html>